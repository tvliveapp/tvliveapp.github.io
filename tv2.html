<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Interfaz TV - HLS + N√∫meros + Categor√≠as</title>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<style>
  body {
    margin: 0;
    background: #000;
    overflow: hidden;
    font-family: Arial, sans-serif;
    color: white;
  }

  video {
    position: fixed;
    top: 0;
    left: 0;
    width: 100vw;
    height: 100vh;
    object-fit: cover;
    z-index: 0;
    background: black;
  }

  .channel-panel {
    position: fixed;
    top: 0;
    left: -420px;
    width: 400px;
    height: 100vh;
    background: rgba(0, 0, 0, 0.88);
    backdrop-filter: blur(6px);
    transition: left 0.3s ease;
    z-index: 10;
    display: flex;
    flex-direction: column;
  }

  .channel-panel.visible {
    left: 0;
  }

  .channel-header {
    flex-shrink: 0;
    padding: 10px 20px;
    display: flex;
    justify-content: flex-end;
    align-items: center;
    font-weight: bold;
    font-size: 1em;
    border-bottom: 1px solid rgba(255,255,255,0.2);
    color: #ccc;
  }

  .category-tabs {
    display: flex;
    overflow-x: auto;
    padding: 8px 10px;
    background: rgba(255, 255, 255, 0.08);
    border-bottom: 1px solid rgba(255,255,255,0.15);
  }

  .category-tab {
    padding: 8px 15px;
    margin: 0 5px;
    border-radius: 15px;
    background: rgba(255,255,255,0.1);
    color: #aaa;
    font-size: 0.9em;
    white-space: nowrap;
    transition: background 0.3s, color 0.3s;
  }

  .category-tab.active {
    background: #1e90ff;
    color: white;
    font-weight: bold;
  }

  .channel-list {
    flex: 1;
    overflow-y: auto;
    padding: 10px 15px;
  }

  .channel-item {
    padding: 12px 15px;
    margin: 6px 0;
    border-radius: 5px;
    transition: background 0.2s, transform 0.1s;
    cursor: pointer;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .channel-item img {
    width: 32px;
    height: 32px;
    border-radius: 5px;
  }

  .channel-item.selected {
    background: #1e90ff;
    transform: scale(1.05);
  }

  .info-overlay {
    position: fixed;
    bottom: 40px;
    left: 40px;
    background: rgba(0, 0, 0, 0.7);
    padding: 15px 20px;
    border-radius: 10px;
    display: flex;
    align-items: center;
    gap: 15px;
    animation: fadeIn 0.3s ease;
    z-index: 5;
  }

  .info-overlay.hidden {
    display: none;
  }

  .overlay-logo {
    width: 60px;
    height: 60px;
    border-radius: 8px;
    object-fit: cover;
  }

  .overlay-text {
    display: flex;
    flex-direction: column;
  }

  .overlay-channel {
    font-weight: bold;
    font-size: 1.2em;
  }

  .overlay-program {
    font-size: 0.9em;
    color: #ccc;
    overflow: hidden;
    white-space: nowrap;
    animation: marquee 10s linear infinite;
  }

  @keyframes marquee {
    0% { transform: translateX(0); }
    100% { transform: translateX(-100%); }
  }

  .info {
    position: fixed;
    bottom: 10px;
    left: 20px;
    z-index: 5;
    color: rgba(255,255,255,0.7);
    font-size: 0.9em;
  }

  .number-overlay {
    position: fixed;
    top: 40%;
    left: 50%;
    transform: translate(-50%, -50%);
    font-size: 4em;
    font-weight: bold;
    color: white;
    text-shadow: 2px 2px 10px black;
    z-index: 20;
    opacity: 0;
    transition: opacity 0.3s;
  }

  .number-overlay.visible {
    opacity: 1;
  }
</style>
</head>
<body>

<video id="tv-video" autoplay muted controls></video>

<div class="channel-panel" id="channel-panel">
  <div class="channel-header">
    <div id="channel-time">00:00</div>
  </div>

  <div class="category-tabs" id="category-tabs"></div>
  <div class="channel-list" id="channel-list"></div>
</div>

<div class="info-overlay hidden" id="info-overlay">
  <img class="overlay-logo" id="overlay-logo" src="">
  <div class="overlay-text">
    <div class="overlay-channel" id="overlay-channel"></div>
    <div class="overlay-program" id="overlay-program"></div>
  </div>
</div>

<div class="number-overlay" id="number-overlay"></div>
<div class="info">‚¨ÖÔ∏è‚û°Ô∏è Categor√≠a | ‚Üë‚Üì Canales | ‚èé Selecciona | Esc Cierra | 0‚Äì9 Num√©rico</div>

<script>
  const video = document.getElementById('tv-video');
  const panel = document.getElementById('channel-panel');
  const list = document.getElementById('channel-list');
  const overlay = document.getElementById('info-overlay');
  const overlayLogo = document.getElementById('overlay-logo');
  const overlayChannel = document.getElementById('overlay-channel');
  const overlayProgram = document.getElementById('overlay-program');
  const timeLabel = document.getElementById('channel-time');
  const categoryTabs = document.getElementById('category-tabs');
  const numberOverlay = document.getElementById('number-overlay');

  // üì∫ Lista de categor√≠as
  const categorias = [
    {
      nombre: "TV en Vivo",
      canales: [
        {
          nombre: "Canal 1 - ESPN2",
          programa: "Deportes en directo",
          video: "https://98ca2.crackstreamslivehd.com/espn2/index.m3u8?token=a156f65d787c4a63f3075b145e9a8f49ac99b0d5-df-1762446893-1762392893&ip=45.225.44.89",
          logo: "https://upload.wikimedia.org/wikipedia/commons/2/2f/ESPN_wordmark.svg",
          live: true
        }
      ]
    },
    {
      nombre: "Noticias",
      canales: [
        {nombre: "Canal 2 - Internacional", programa: "Noticias globales", video: "https://www.w3schools.com/html/mov_bbb.mp4", logo: "https://upload.wikimedia.org/wikipedia/commons/6/6c/TV_icon_2.svg"},
        {nombre: "Canal 3 - Nacional", programa: "Titulares del d√≠a", video: "https://www.w3schools.com/html/movie.mp4", logo: "https://upload.wikimedia.org/wikipedia/commons/6/6c/TV_icon_2.svg"}
      ]
    },
    {
      nombre: "M√∫sica",
      canales: [
        {nombre: "Canal 4 - Pop Hits", programa: "Top 10 del momento", video: "https://cdn.pixabay.com/video/2021/09/21/88369-615371202_large.mp4", logo: "https://upload.wikimedia.org/wikipedia/commons/8/84/Music_icon.svg"},
        {nombre: "Canal 5 - Rock TV", programa: "Rock Cl√°sico", video: "https://cdn.pixabay.com/video/2023/06/13/167267-836065889_large.mp4", logo: "https://upload.wikimedia.org/wikipedia/commons/8/84/Music_icon.svg"}
      ]
    }
  ];

  // Agregar categor√≠a "Todos"
  const todos = { nombre: "Todos", canales: categorias.flatMap(c => c.canales) };
  categorias.unshift(todos);

  let categoriaActual = 0;
  let canalSeleccionado = 0;
  let panelVisible = false;
  let overlayTimeout, inactivityTimer, numberBuffer = "", numberTimer;

  function playVideo(url, isLive=false) {
    if (Hls.isSupported() && url.endsWith(".m3u8")) {
      const hls = new Hls();
      hls.loadSource(url);
      hls.attachMedia(video);
      hls.on(Hls.Events.MANIFEST_PARSED, () => video.play());
    } else {
      video.src = url;
      video.play();
    }
  }

  function generarTabs() {
    categoryTabs.innerHTML = "";
    categorias.forEach((cat, i) => {
      const tab = document.createElement("div");
      tab.className = "category-tab" + (i === categoriaActual ? " active" : "");
      tab.textContent = cat.nombre;
      categoryTabs.appendChild(tab);
    });
  }

  function generarLista() {
    list.innerHTML = "";
    categorias[categoriaActual].canales.forEach((canal, i) => {
      const div = document.createElement("div");
      div.className = "channel-item" + (i === canalSeleccionado ? " selected" : "");
      div.innerHTML = `<img src="${canal.logo}">${canal.nombre}`;
      list.appendChild(div);
    });
  }

  function updateSelection() {
    document.querySelectorAll(".channel-item").forEach((ch, i) =>
      ch.classList.toggle("selected", i === canalSeleccionado)
    );
    document.querySelectorAll(".category-tab").forEach((t, i) =>
      t.classList.toggle("active", i === categoriaActual)
    );
    document.querySelectorAll(".channel-item")[canalSeleccionado]?.scrollIntoView({ block: "nearest", behavior: "smooth" });
  }

  function changeChannel() {
    const canal = categorias[categoriaActual].canales[canalSeleccionado];
    playVideo(canal.video, canal.live);
    showOverlay(canal.nombre, canal.programa, canal.logo);
  }

  function showOverlay(nombre, programa, logo) {
    overlayLogo.src = logo;
    overlayChannel.textContent = nombre;
    overlayProgram.textContent = programa;
    overlay.classList.remove("hidden");
    clearTimeout(overlayTimeout);
    overlayTimeout = setTimeout(() => overlay.classList.add("hidden"), 4000);
  }

  function updateTime() {
    const now = new Date();
    timeLabel.textContent = now.toLocaleTimeString([], {hour: '2-digit', minute: '2-digit'});
  }
  setInterval(updateTime, 1000);
  updateTime();

  generarTabs();
  generarLista();

  function resetInactivityTimer() {
    clearTimeout(inactivityTimer);
    if (panelVisible) {
      inactivityTimer = setTimeout(() => {
        panelVisible = false;
        panel.classList.remove("visible");
      }, 5000);
    }
  }

  document.addEventListener("keydown", (e) => {
    resetInactivityTimer();

    if (/^[0-9]$/.test(e.key)) {
      numberBuffer += e.key;
      numberOverlay.textContent = numberBuffer;
      numberOverlay.classList.add("visible");
      clearTimeout(numberTimer);
      numberTimer = setTimeout(() => {
        const num = parseInt(numberBuffer);
        const todosCanales = categorias[0].canales;
        if (num > 0 && num <= todosCanales.length) {
          canalSeleccionado = num - 1;
          categoriaActual = 0;
          generarTabs();
          generarLista();
          changeChannel();
        }
        numberBuffer = "";
        numberOverlay.classList.remove("visible");
      }, 1500);
      return;
    }

    switch (e.key) {
      case "ArrowLeft":
        if (!panelVisible) { panelVisible = true; panel.classList.add("visible"); }
        else { categoriaActual = (categoriaActual - 1 + categorias.length) % categorias.length; canalSeleccionado = 0; generarTabs(); generarLista(); }
        break;
      case "ArrowRight":
        if (panelVisible) { categoriaActual = (categoriaActual + 1) % categorias.length; canalSeleccionado = 0; generarTabs(); generarLista(); }
        break;
      case "ArrowUp":
        canalSeleccionado = (canalSeleccionado - 1 + categorias[categoriaActual].canales.length) % categorias[categoriaActual].canales.length;
        updateSelection();
        if (!panelVisible) changeChannel();
        break;
      case "ArrowDown":
        canalSeleccionado = (canalSeleccionado + 1) % categorias[categoriaActual].canales.length;
        updateSelection();
        if (!panelVisible) changeChannel();
        break;
      case "Enter":
        if (panelVisible) { changeChannel(); panelVisible = false; panel.classList.remove("visible"); }
        break;
      case "Escape":
        panelVisible = false;
        panel.classList.remove("visible");
        break;
    }
  });
</script>

</body>
</html>
