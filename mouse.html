<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Prueba Gesture TV</title>
<style>
  body { margin:0; background:black; color:white; font-family:Arial,sans-serif; overflow:hidden;}
  video { width:100vw; height:100vh; object-fit:cover; display:block; }

  /* Info canal */
  .info { position:fixed; bottom:20px; left:20px; background:rgba(0,0,0,0.6); padding:10px 15px; border-radius:8px; font-size:1.2em; }

  /* Coordenadas */
  .coords { position:fixed; top:20px; left:20px; background:rgba(0,0,0,0.6); padding:8px 12px; border-radius:6px; font-size:1em; }

  /* Indicador visual de gesto */
  .indicator { position:fixed; top:20px; right:20px; width:50px; height:50px; background:gray; border-radius:50%; opacity:1; transition:opacity 0.1s, background 0.1s; }

  /* Temporizador */
  .timer { position:fixed; top:80px; right:20px; background:rgba(0,0,0,0.6); padding:5px 10px; border-radius:6px; font-size:1em; }
</style>
</head>
<body>

<video id="tv-video" autoplay muted loop>
  <source src="https://www.w3schools.com/html/mov_bbb.mp4" type="video/mp4">
</video>

<div class="info" id="info">Canal: 1</div>
<div class="coords" id="coords">X: 0, Y: 0</div>
<div class="indicator" id="indicator"></div>
<div class="timer" id="timer">Tiempo desde primer gesto: 0s</div>

<script type="module">
import { GestureController } from "./gesture-tv.js";

// --- Canales de prueba
const categorias = [{nombre:"Todos", canales:[
  {nombre:"Canal 1", video:"https://www.w3schools.com/html/mov_bbb.mp4"},
  {nombre:"Canal 2", video:"https://www.w3schools.com/html/movie.mp4"},
  {nombre:"Canal 3", video:"https://www.w3schools.com/html/mov_bbb.mp4"}
]}];

let categoriaActual=0, canalSeleccionado=0;
const video=document.getElementById("tv-video");
const info=document.getElementById("info");
const coords=document.getElementById("coords");

function playChannel() {
  video.src = categorias[categoriaActual].canales[canalSeleccionado].video;
  video.play();
  info.textContent = "Canal: " + (canalSeleccionado + 1);
}
playChannel();

// --- Actualizar coordenadas del mouse
document.addEventListener("mousemove", e => {
  coords.textContent = `X: ${e.clientX}, Y: ${e.clientY}`;
});

// --- Inicializar GestureController
const indicator = document.getElementById("indicator");
const timerLabel = document.getElementById("timer");

const gesture = new GestureController({
  maxIncrement: 20,
  minInterval: 500,
  maxInterval: 1000,
  resetDelay: 3000,
  indicator,
  timerLabel,
  onKey: (key)=>{
    // Disparar cambio de canal
    if(key === "ArrowUp") canalSeleccionado = (canalSeleccionado-1+categorias[categoriaActual].canales.length)%categorias[categoriaActual].canales.length;
    if(key === "ArrowDown") canalSeleccionado = (canalSeleccionado+1)%categorias[categoriaActual].canales.length;
    if(key === "ArrowLeft") console.log("Movimiento horizontal izquierda");
    if(key === "ArrowRight") console.log("Movimiento horizontal derecha");
    playChannel();
  }
});
</script>
</body>
</html>
