<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Prueba Gesture TV</title>
<style>
  body { margin:0; background:black; color:white; font-family:Arial,sans-serif; }
  video { width:100vw; height:100vh; object-fit:cover; display:block; }
  .indicator {
    position:fixed; top:50%; left:50%;
    transform:translate(-50%,-50%);
    font-size:4em; padding:20px 30px;
    background:gray; border-radius:15px; text-align:center;
    transition: background 0.3s, opacity 0.3s;
    z-index:10;
  }
  .timer, .keyLabel, .log {
    position:fixed; left:20px; padding:5px 10px; background:rgba(0,0,0,0.6); border-radius:6px; font-size:1em;
  }
  .timer { top:20px; }
  .keyLabel { top:60px; }
  .log { bottom:20px; left:20px; max-height:150px; overflow:auto; width:250px; }
</style>
</head>
<body>

<video id="tv-video" autoplay muted loop>
  <source src="https://www.w3schools.com/html/mov_bbb.mp4" type="video/mp4">
</video>

<div class="indicator" id="indicator">â†‘</div>
<div class="timer" id="timer">Tiempo: 0.0s</div>
<div class="keyLabel" id="keyLabel">Tecla: -</div>
<div class="log" id="log">Log:</div>

<script type="module">
import { GestureController } from './gesture-tv.js';

const video = document.getElementById('tv-video');
const indicator = document.getElementById('indicator');
const timerLabel = document.getElementById('timer');
const keyLabel = document.getElementById('keyLabel');
const log = document.getElementById('log');

const channels = [
  "https://www.w3schools.com/html/mov_bbb.mp4",
  "https://www.w3schools.com/html/movie.mp4",
  "https://www.w3schools.com/html/mov_bbb.mp4"
];

let currentChannel = 0;

function playChannel(index) {
  video.src = channels[index];
  video.play();
  logMessage(`Canal cambiado a: ${index + 1}`);
}

function logMessage(msg) {
  log.textContent += "\n" + msg;
  log.scrollTop = log.scrollHeight;
}

// Inicial canal
playChannel(currentChannel);

// Crear controlador de gestos
const gesture = new GestureController({
  indicator,
  timerLabel,
  maxIncrement: 20,
  minInterval: 500,
  maxInterval: 1000,
  resetDelay: 3000,
  colorTransition: true,
  onKey: (key) => {
    keyLabel.textContent = "Tecla: " + key;
    if(key === 'ArrowUp') {
      currentChannel = (currentChannel - 1 + channels.length) % channels.length;
      playChannel(currentChannel);
    } else if(key === 'ArrowDown') {
      currentChannel = (currentChannel + 1) % channels.length;
      playChannel(currentChannel);
    } else {
      logMessage(`Movimiento horizontal detectado: ${key}`);
    }
  }
});
</script>

</body>
</html>
